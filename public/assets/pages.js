$(document).ready(function(){if(typeof $.fn.toggleMe!="undefined"){$("#pages-list ul.folder img.toggler").toggleMe()}$("#pages-list ul.folder").sortable({handle:"em",axis:"y",update:function(c,d){var e=$(this).sortable("serialize",{key:"children[]"});e+="&_method=put";e+="&"+$("meta[name=csrf-param]").attr("content")+"="+$("meta[name=csrf-token]").attr("content");$.post($(this).attr("data-url"),e,function(g){var f=typeof(g.error)!="undefined";$.growl((f?"error":"success"),(f?g.error:g.notice))},"json")}});$.subscribe("toggle.page_templatized.checked",function(c,d){$("#page_slug_input").hide();$("#page_redirect").parent("li").hide();$("#page_listed").parent("li").hide();$("#page_content_type_id_input").show()},[]);$.subscribe("toggle.page_templatized.unchecked",function(c,d){$("#page_slug_input").show();$("#page_redirect").parent("li").show();$("#page_listed").parent("li").show();$("#page_slug").val(makeSlug($("#page_title").val())).addClass("touched");$("#page_content_type_id_input").hide()},[]);var a=$(".formtastic.page fieldset#advanced-options");$.subscribe("toggle.page_redirect.checked",function(c,d){$("#page_templatized").parent("li").hide();$("#page_cache_strategy_input").hide();$("#page_redirect_url_input").show();a.trigger("refresh")},[]);$.subscribe("toggle.page_redirect.unchecked",function(c,d){$("#page_templatized").parent("li").show();$("#page_cache_strategy_input").show();$("#page_redirect_url_input").hide();a.trigger("refresh")},[]);$("#page_title").keypress(function(){var d=$(this);var c=$("#page_slug");if(!c.hasClass("filled")){setTimeout(function(){c.val(makeSlug(d.val(),"-")).addClass("touched")},50)}});$("#page_slug").keypress(function(){$(this).addClass("filled").addClass("touched")});var b=function(){params="parent_id="+$("#page_parent_id").val()+"&slug="+$("#page_slug").val();$.get($("#page_slug").attr("data-url"),params,function(c){$("#page_slug_input .inline-hints").html(c.url).effect("highlight")},"json")};$("#page_parent_id").change(b);setInterval(function(){var c=$("#page_slug");if(c.hasClass("touched")){c.removeClass("touched");b()}},2000);if(typeof $.fn.imagepicker!="undefined"){$("a#image-picker-link").imagepicker({insertFn:function(c){return"{{ '/"+c.attr("data-local-path")+"' | theme_image_url }}"}})}});$.fn.toggleMe=function(b){b=$.extend({},b);var a=function(d){var e=$(this);var c=e.parent().find("> ul.folder");c.each(function(){var f=$(this);if(f.is(":visible")){f.slideUp("fast",function(){e.attr("src",e.attr("src").replace("open","closed"));$.cookie(f.attr("id"),"none")})}else{f.slideDown("fast",function(){e.attr("src",e.attr("src").replace("closed","open"));$.cookie(f.attr("id"),"block")})}})};return $(this).bind("click",a)};